
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This repository contains the Markov Chain Monte Carlo implementations we call openMCMC. It is part of the pyELQ project.">
      
      
        <meta name="author" content="openMCMC">
      
      
      
        <link rel="prev" href="../distribution/">
      
      
        <link rel="next" href="../../gmrf/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Location Scale - openMCMC</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


  
  
    
    
      
    
    
  
  
  <style>.md-tag.md-tag--pipelines{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M128 72a24 24 0 1 1 0 48 24 24 0 1 1 0-48zm32 97.3c28.3-12.3 48-40.5 48-73.3 0-44.2-35.8-80-80-80S48 51.8 48 96c0 32.8 19.7 61 48 73.3V224H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h256v54.7c-28.3 12.3-48 40.5-48 73.3 0 44.2 35.8 80 80 80s80-35.8 80-80c0-32.8-19.7-61-48-73.3V288h256c17.7 0 32-14.3 32-32s-14.3-32-32-32h-64v-54.7c28.3-12.3 48-40.5 48-73.3 0-44.2-35.8-80-80-80s-80 35.8-80 80c0 32.8 19.7 61 48 73.3V224H160v-54.7zM488 96a24 24 0 1 1 48 0 24 24 0 1 1-48 0zM320 392a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>');}</style>

    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#location-scale" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="openMCMC" class="md-header__button md-logo" aria-label="openMCMC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            openMCMC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Location Scale
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sede-open/openMCMC" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    openMCMC
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../distribution/" class="md-tabs__link">
          
  
    
  
  openMCMC User Guide

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="openMCMC" class="md-nav__button md-logo" aria-label="openMCMC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    openMCMC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sede-open/openMCMC" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    openMCMC
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    openMCMC User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            openMCMC User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Distribution
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Distribution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../distribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Location Scale
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Location Scale
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale" class="md-nav__link">
    <span class="md-ellipsis">
      location_scale
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LocationScale" class="md-nav__link">
    <span class="md-ellipsis">
      LocationScale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LocationScale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LocationScale.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.NullDistribution" class="md-nav__link">
    <span class="md-ellipsis">
      NullDistribution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NullDistribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.NullDistribution.log_p" class="md-nav__link">
    <span class="md-ellipsis">
      log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.NullDistribution.grad_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      grad_log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.NullDistribution.rvs" class="md-nav__link">
    <span class="md-ellipsis">
      rvs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.Normal" class="md-nav__link">
    <span class="md-ellipsis">
      Normal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Normal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.Normal.log_p" class="md-nav__link">
    <span class="md-ellipsis">
      log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.Normal.check_domain_response" class="md-nav__link">
    <span class="md-ellipsis">
      check_domain_response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.Normal.grad_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      grad_log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.Normal.rvs" class="md-nav__link">
    <span class="md-ellipsis">
      rvs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LogNormal" class="md-nav__link">
    <span class="md-ellipsis">
      LogNormal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogNormal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LogNormal.log_p" class="md-nav__link">
    <span class="md-ellipsis">
      log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LogNormal.grad_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      grad_log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LogNormal.hessian_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      hessian_log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LogNormal.rvs" class="md-nav__link">
    <span class="md-ellipsis">
      rvs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gmrf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GMRF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mcmc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MCMC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parameter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sampler
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Sampler
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sampler/sampler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sampler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sampler/metropolis_hastings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metropolis-Hastings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sampler/reversible_jump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reversible Jump
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale" class="md-nav__link">
    <span class="md-ellipsis">
      location_scale
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LocationScale" class="md-nav__link">
    <span class="md-ellipsis">
      LocationScale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LocationScale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LocationScale.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.NullDistribution" class="md-nav__link">
    <span class="md-ellipsis">
      NullDistribution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NullDistribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.NullDistribution.log_p" class="md-nav__link">
    <span class="md-ellipsis">
      log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.NullDistribution.grad_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      grad_log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.NullDistribution.rvs" class="md-nav__link">
    <span class="md-ellipsis">
      rvs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.Normal" class="md-nav__link">
    <span class="md-ellipsis">
      Normal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Normal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.Normal.log_p" class="md-nav__link">
    <span class="md-ellipsis">
      log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.Normal.check_domain_response" class="md-nav__link">
    <span class="md-ellipsis">
      check_domain_response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.Normal.grad_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      grad_log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.Normal.rvs" class="md-nav__link">
    <span class="md-ellipsis">
      rvs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LogNormal" class="md-nav__link">
    <span class="md-ellipsis">
      LogNormal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogNormal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LogNormal.log_p" class="md-nav__link">
    <span class="md-ellipsis">
      log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LogNormal.grad_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      grad_log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LogNormal.hessian_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      hessian_log_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmcmc.distribution.location_scale.LogNormal.rvs" class="md-nav__link">
    <span class="md-ellipsis">
      rvs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<!--
SPDX-FileCopyrightText: 2024 Shell Global Solutions International B.V. All Rights Reserved.

SPDX-License-Identifier: Apache-2.0
-->

<h1 id="location-scale">Location Scale</h1>


<div class="doc doc-object doc-module">



<a id="openmcmc.distribution.location_scale"></a>
    <div class="doc doc-contents first">

      <p>LocationScale module.</p>
<p>This module provides a class definition of the LocationScale class an abstract base class for distributions defined by a
mean and a precision such as the Normal and Lognormal.</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="openmcmc.distribution.location_scale.LocationScale" class="doc doc-heading">
            <code>LocationScale</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="openmcmc.distribution.distribution.Distribution" href="../distribution/#openmcmc.distribution.distribution.Distribution">Distribution</a></code>, <code><span title="abc.ABC">ABC</span></code></p>


      <p>Abstract base class for distributions defined by a mean and a precision such as the Normal and Lognormal.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="openmcmc.distribution.location_scale.LocationScale.mean">mean</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, <a class="autorefs autorefs-internal" title="openmcmc.parameter.Identity" href="../../parameter/#openmcmc.parameter.Identity">Identity</a>, <a class="autorefs autorefs-internal" title="openmcmc.parameter.LinearCombination" href="../../parameter/#openmcmc.parameter.LinearCombination">LinearCombination</a>, <a class="autorefs autorefs-internal" title="openmcmc.parameter.MixtureParameterVector" href="../../parameter/#openmcmc.parameter.MixtureParameterVector">MixtureParameterVector</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>mean parameter (of class Parameter).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="openmcmc.distribution.location_scale.LocationScale.precision">precision</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, <a class="autorefs autorefs-internal" title="openmcmc.parameter.Identity" href="../../parameter/#openmcmc.parameter.Identity">Identity</a>, <a class="autorefs autorefs-internal" title="openmcmc.parameter.ScaledMatrix" href="../../parameter/#openmcmc.parameter.ScaledMatrix">ScaledMatrix</a>, <a class="autorefs autorefs-internal" title="openmcmc.parameter.MixtureParameterMatrix" href="../../parameter/#openmcmc.parameter.MixtureParameterMatrix">MixtureParameterMatrix</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>precision parameter (of class Parameter).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">LocationScale</span><span class="p">(</span><span class="n">Distribution</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for distributions defined by a mean and a precision such as the Normal and Lognormal.</span>

<span class="sd">    Attributes:</span>
<span class="sd">       mean (Union[str, Identity, LinearCombination, MixtureParameterVector]): mean parameter (of class Parameter).</span>
<span class="sd">       precision (Union[str, Identity, ScaledMatrix, MixtureParameterMatrix]): precision parameter (of class Parameter).</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mean</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Identity</span><span class="p">,</span> <span class="n">LinearCombination</span><span class="p">,</span> <span class="n">MixtureParameterVector</span><span class="p">]</span>
    <span class="n">precision</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Identity</span><span class="p">,</span> <span class="n">ScaledMatrix</span><span class="p">,</span> <span class="n">MixtureParameterMatrix</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_dist_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the full list of state elements used in the mean and precision parameters.&quot;&quot;&quot;</span>
        <span class="n">lst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">get_param_list</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">get_param_list</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">lst</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse any str parameter inputs as Parameter classes.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="p">(</span><span class="n">Identity</span><span class="p">,</span> <span class="n">LinearCombination</span><span class="p">,</span> <span class="n">MixtureParameterVector</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;mean expected to be one of [Identity, LinearCombination, MixtureParameterVector]&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span> <span class="p">(</span><span class="n">Identity</span><span class="p">,</span> <span class="n">ScaledMatrix</span><span class="p">,</span> <span class="n">MixtureParameterMatrix</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;precision expected to be one of [Identity, ScaledMatrix, MixtureParameterMatrix]&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.LocationScale.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Parse any str parameter inputs as Parameter classes.</p>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse any str parameter inputs as Parameter classes.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="p">(</span><span class="n">Identity</span><span class="p">,</span> <span class="n">LinearCombination</span><span class="p">,</span> <span class="n">MixtureParameterVector</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;mean expected to be one of [Identity, LinearCombination, MixtureParameterVector]&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span> <span class="p">(</span><span class="n">Identity</span><span class="p">,</span> <span class="n">ScaledMatrix</span><span class="p">,</span> <span class="n">MixtureParameterMatrix</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;precision expected to be one of [Identity, ScaledMatrix, MixtureParameterMatrix]&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="openmcmc.distribution.location_scale.NullDistribution" class="doc doc-heading">
            <code>NullDistribution</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="openmcmc.distribution.location_scale.LocationScale" href="#openmcmc.distribution.location_scale.LocationScale">LocationScale</a></code></p>


      <p>Null distribution, which returns 0 for the log-likelihood, a zero vector for the gradient and a zero matrix for the Hessian.</p>
<p>Used in prior recovery testing for reversible jump sampler.</p>

              <details class="quote">
                <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">NullDistribution</span><span class="p">(</span><span class="n">LocationScale</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Null distribution, which returns 0 for the log-likelihood, a zero vector for the gradient and a zero matrix for the Hessian.</span>

<span class="sd">    Used in prior recovery testing for reversible jump sampler.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">log_p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">by_observation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Null log-density function: returns 0.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): dictionary object containing the current state information. state[distribution.response]</span>
<span class="sd">                is expected to be p x n where: p is the number of responses; n is the number of independent</span>
<span class="sd">                replicates/observations.</span>
<span class="sd">            by_observation (bool, optional): If True, the log-likelihood is returned for each of the p responses of</span>
<span class="sd">                the distribution separately. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (float): 0.0.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">grad_log_p</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hessian_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Null gradient function returning an all-zero vector for the gradient, and an all-zero matrix for the Hessian.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): current state information.</span>
<span class="sd">            param (str): name of the parameter for which we compute derivatives.</span>
<span class="sd">            hessian_required (bool): flag for whether the Hessian should be calculated and supplied as an output.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Union[np.ndarray, Tuple[np.ndarray, np.ndarray]]): if hessian_required=True, then a tuple of (gradient,</span>
<span class="sd">                hessian) is returned. If hessian_required=False, then just a gradient vector is returned. The returned</span>
<span class="sd">                values are as follows:</span>
<span class="sd">                grad (np.ndarray): all-zero vector. shape=(d, 1), where d is the dimensionality of param.</span>
<span class="sd">                hessian (np.ndarray): all-zero matrix. shape=(d, d), where d is the dimensionality of param.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">hessian_required</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Null random sampling function.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): dictionary object containing the current state information.</span>
<span class="sd">            n (int, optional): specifies the number of replicate samples required. Defaults to 1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (None): simply returns None value.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.NullDistribution.log_p" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_p</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">by_observation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Null log-density function: returns 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary object containing the current state information. state[distribution.response]
is expected to be p x n where: p is the number of responses; n is the number of independent
replicates/observations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>by_observation</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the log-likelihood is returned for each of the p responses of
the distribution separately. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0.0.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">log_p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">by_observation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Null log-density function: returns 0.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): dictionary object containing the current state information. state[distribution.response]</span>
<span class="sd">            is expected to be p x n where: p is the number of responses; n is the number of independent</span>
<span class="sd">            replicates/observations.</span>
<span class="sd">        by_observation (bool, optional): If True, the log-likelihood is returned for each of the p responses of</span>
<span class="sd">            the distribution separately. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): 0.0.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.NullDistribution.grad_log_p" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">grad_log_p</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">hessian_required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Null gradient function returning an all-zero vector for the gradient, and an all-zero matrix for the Hessian.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>current state information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the parameter for which we compute derivatives.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>hessian_required</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>flag for whether the Hessian should be calculated and supplied as an output.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="typing.Tuple">Tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if hessian_required=True, then a tuple of (gradient,
hessian) is returned. If hessian_required=False, then just a gradient vector is returned. The returned
values are as follows:
grad (np.ndarray): all-zero vector. shape=(d, 1), where d is the dimensionality of param.
hessian (np.ndarray): all-zero matrix. shape=(d, d), where d is the dimensionality of param.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">grad_log_p</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hessian_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Null gradient function returning an all-zero vector for the gradient, and an all-zero matrix for the Hessian.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): current state information.</span>
<span class="sd">        param (str): name of the parameter for which we compute derivatives.</span>
<span class="sd">        hessian_required (bool): flag for whether the Hessian should be calculated and supplied as an output.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[np.ndarray, Tuple[np.ndarray, np.ndarray]]): if hessian_required=True, then a tuple of (gradient,</span>
<span class="sd">            hessian) is returned. If hessian_required=False, then just a gradient vector is returned. The returned</span>
<span class="sd">            values are as follows:</span>
<span class="sd">            grad (np.ndarray): all-zero vector. shape=(d, 1), where d is the dimensionality of param.</span>
<span class="sd">            hessian (np.ndarray): all-zero matrix. shape=(d, d), where d is the dimensionality of param.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">hessian_required</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.NullDistribution.rvs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rvs</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Null random sampling function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary object containing the current state information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specifies the number of replicate samples required. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>simply returns None value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Null random sampling function.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): dictionary object containing the current state information.</span>
<span class="sd">        n (int, optional): specifies the number of replicate samples required. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (None): simply returns None value.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="openmcmc.distribution.location_scale.Normal" class="doc doc-heading">
            <code>Normal</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="openmcmc.distribution.location_scale.LocationScale" href="#openmcmc.distribution.location_scale.LocationScale">LocationScale</a></code></p>


      <p>Multivariate normal distribution class.</p>
<p>Supports both standard multivariate normal and truncated normal distribution cases. By default, no truncation is
assumed. To truncate the distribution, one or both of self.domain_response_lower or self.domain_response_upper must
be specified.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="openmcmc.distribution.location_scale.Normal.domain_response_lower">domain_response_lower</span></code></td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>check lower bound domain to implement truncated sampling. Defaults
to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="openmcmc.distribution.location_scale.Normal.domain_response_upper">domain_response_upper</span></code></td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>check upper bound domain to implement truncated sampling. Defaults
to None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Normal</span><span class="p">(</span><span class="n">LocationScale</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Multivariate normal distribution class.</span>

<span class="sd">    Supports both standard multivariate normal and truncated normal distribution cases. By default, no truncation is</span>
<span class="sd">    assumed. To truncate the distribution, one or both of self.domain_response_lower or self.domain_response_upper must</span>
<span class="sd">    be specified.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        domain_response_lower (np.array, optional): check lower bound domain to implement truncated sampling. Defaults</span>
<span class="sd">            to None.</span>
<span class="sd">        domain_response_upper (np.array, optional): check upper bound domain to implement truncated sampling. Defaults</span>
<span class="sd">            to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">domain_response_lower</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">domain_response_upper</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">log_p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">by_observation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the log of the probability density for a given state.</span>

<span class="sd">        NOTE: This function simply computes the non-truncated Gaussian density: i.e. the extra normalization for the</span>
<span class="sd">        truncation is NOT accounted for. Relative densities (differences of log-probabilities) are still valid when</span>
<span class="sd">        comparing different response parameter values (with fixed mean and precision parameter values). Comparisons</span>
<span class="sd">        for different mean or precision parameters are not valid, since such changes would affect the normalization.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): dictionary object containing the current parameter information.</span>
<span class="sd">            by_observation (bool, optional): indicates whether log-density should be computed for each individual</span>
<span class="sd">                response in the distribution. Defaults to False (i.e. the overall log-density is computed).</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Union[np.ndarray, float]): log-density computed using the values in state.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_domain_response</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">log_p</span> <span class="o">=</span> <span class="n">gmrf</span><span class="o">.</span><span class="n">multivariate_normal_pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">],</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">by_observation</span><span class="o">=</span><span class="n">by_observation</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">log_p</span>

    <span class="k">def</span> <span class="nf">check_domain_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks whether the distributional response lies OUTSIDE the defined limits.</span>

<span class="sd">        Returns True if the current value of self.response in the supplied state lies OUTSIDE the stated domain;</span>
<span class="sd">        returns False otherwise.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): dictionary object containing the current parameter information.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (bool): True when the response lies OUTSIDE the valid response domain; False when it lies INSIDE.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_lower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_lower</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_upper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_upper</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">grad_log_p</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hessian_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gradient and Hessian of the log-Gaussian density, with respect to a given parameter.</span>

<span class="sd">        See also distribution.grad_log_p() for more information.</span>

<span class="sd">        Handles three possibilities:</span>
<span class="sd">            1) param is the response of the distribution, in which case the standard gradient of the log-density is</span>
<span class="sd">                returned.</span>
<span class="sd">            2) param is a parameter used in the computation of the mean (through a parameter object) and not in the</span>
<span class="sd">                computation of the precision, in which case the gradient is computed through application of the chain</span>
<span class="sd">                rule. Note that the Hessian calculated in this case is only valid if the dependence of self.mean on</span>
<span class="sd">                param is linear.</span>
<span class="sd">            3) neither of the above conditions is True, in which case the default finite-difference gradient is</span>
<span class="sd">                calculated (using self.grad_log_p_diff() and self.hessian_log_p_diff()). Note that as per those</span>
<span class="sd">                docstrings, it is only possible to compute gradients with respect to scalar or vector parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): current state information.</span>
<span class="sd">            param (str): name of the parameter for which we compute derivatives.</span>
<span class="sd">            hessian_required (bool): flag for whether the Hessian should be calculated and supplied as an output.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Union[np.ndarray, Tuple[np.ndarray, np.ndarray]]): if hessian_required=True, then a tuple of (gradient,</span>
<span class="sd">                hessian) is returned. If hessian_required=False, then just a gradient vector is returned. The returned</span>
<span class="sd">                values are as follows:</span>
<span class="sd">                grad (np.ndarray): vector gradients of the POSITIVE log-pdf with respect to param. shape=(n_param, 1)</span>
<span class="sd">                hessian (np.ndarray): array of NEGATIVE second derivatives of the log-pdf with respect to param.</span>
<span class="sd">                shape=(n_param, n_param)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">:</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">grad</span> <span class="o">=</span> <span class="o">-</span><span class="n">Q</span> <span class="o">@</span> <span class="n">r</span>
            <span class="k">if</span> <span class="n">hessian_required</span><span class="p">:</span>
                <span class="n">hessian</span> <span class="o">=</span> <span class="n">Q</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sparse</span><span class="o">.</span><span class="n">issparse</span><span class="p">(</span><span class="n">Q</span><span class="p">):</span>
                    <span class="n">hessian</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">elif</span> <span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">hessian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">return</span> <span class="n">grad</span><span class="p">,</span> <span class="n">hessian</span>

        <span class="k">elif</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">()</span> <span class="ow">and</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">():</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">grad_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
            <span class="n">grad_times_prec</span> <span class="o">=</span> <span class="n">grad_param</span> <span class="o">@</span> <span class="n">Q</span>
            <span class="n">grad</span> <span class="o">=</span> <span class="n">grad_times_prec</span> <span class="o">@</span> <span class="n">r</span>
            <span class="k">if</span> <span class="n">hessian_required</span><span class="p">:</span>
                <span class="n">hessian</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">grad_times_prec</span> <span class="o">@</span> <span class="n">grad_param</span><span class="o">.</span><span class="n">T</span>
                <span class="k">return</span> <span class="n">grad</span><span class="p">,</span> <span class="n">hessian</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">grad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_log_p_diff</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">hessian_required</span><span class="p">:</span>
                <span class="n">hessian</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessian_log_p_diff</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">grad</span><span class="p">,</span> <span class="n">hessian</span>

        <span class="k">return</span> <span class="n">grad</span>

    <span class="k">def</span> <span class="nf">rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate random samples from the multivariate Gaussian distribution.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): dictionary object containing the current state information.</span>
<span class="sd">            n (int, optional): specifies the number of replicate samples required. Defaults to 1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (np.ndarray): random variables generated from distribution returned as p x n where p is the</span>
<span class="sd">                dimensionality of the response.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_lower</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_upper</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gmrf</span><span class="o">.</span><span class="n">sample_normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">gmrf</span><span class="o">.</span><span class="n">sample_truncated_normal</span><span class="p">(</span>
            <span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_response_lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_response_upper</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.Normal.log_p" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_p</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">by_observation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Compute the log of the probability density for a given state.</p>
<p>NOTE: This function simply computes the non-truncated Gaussian density: i.e. the extra normalization for the
truncation is NOT accounted for. Relative densities (differences of log-probabilities) are still valid when
comparing different response parameter values (with fixed mean and precision parameter values). Comparisons
for different mean or precision parameters are not valid, since such changes would affect the normalization.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary object containing the current parameter information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>by_observation</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>indicates whether log-density should be computed for each individual
response in the distribution. Defaults to False (i.e. the overall log-density is computed).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>log-density computed using the values in state.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">log_p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">by_observation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the log of the probability density for a given state.</span>

<span class="sd">    NOTE: This function simply computes the non-truncated Gaussian density: i.e. the extra normalization for the</span>
<span class="sd">    truncation is NOT accounted for. Relative densities (differences of log-probabilities) are still valid when</span>
<span class="sd">    comparing different response parameter values (with fixed mean and precision parameter values). Comparisons</span>
<span class="sd">    for different mean or precision parameters are not valid, since such changes would affect the normalization.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): dictionary object containing the current parameter information.</span>
<span class="sd">        by_observation (bool, optional): indicates whether log-density should be computed for each individual</span>
<span class="sd">            response in the distribution. Defaults to False (i.e. the overall log-density is computed).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[np.ndarray, float]): log-density computed using the values in state.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_domain_response</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="n">log_p</span> <span class="o">=</span> <span class="n">gmrf</span><span class="o">.</span><span class="n">multivariate_normal_pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">],</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">by_observation</span><span class="o">=</span><span class="n">by_observation</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">log_p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.Normal.check_domain_response" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_domain_response</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Checks whether the distributional response lies OUTSIDE the defined limits.</p>
<p>Returns True if the current value of self.response in the supplied state lies OUTSIDE the stated domain;
returns False otherwise.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary object containing the current parameter information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True when the response lies OUTSIDE the valid response domain; False when it lies INSIDE.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_domain_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks whether the distributional response lies OUTSIDE the defined limits.</span>

<span class="sd">    Returns True if the current value of self.response in the supplied state lies OUTSIDE the stated domain;</span>
<span class="sd">    returns False otherwise.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): dictionary object containing the current parameter information.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool): True when the response lies OUTSIDE the valid response domain; False when it lies INSIDE.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_lower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_lower</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_upper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_upper</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.Normal.grad_log_p" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">grad_log_p</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">hessian_required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Gradient and Hessian of the log-Gaussian density, with respect to a given parameter.</p>
<p>See also distribution.grad_log_p() for more information.</p>


<details class="handles-three-possibilities" open>
  <summary>Handles three possibilities</summary>
  <p>1) param is the response of the distribution, in which case the standard gradient of the log-density is
    returned.
2) param is a parameter used in the computation of the mean (through a parameter object) and not in the
    computation of the precision, in which case the gradient is computed through application of the chain
    rule. Note that the Hessian calculated in this case is only valid if the dependence of self.mean on
    param is linear.
3) neither of the above conditions is True, in which case the default finite-difference gradient is
    calculated (using self.grad_log_p_diff() and self.hessian_log_p_diff()). Note that as per those
    docstrings, it is only possible to compute gradients with respect to scalar or vector parameters.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>current state information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the parameter for which we compute derivatives.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>hessian_required</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>flag for whether the Hessian should be calculated and supplied as an output.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="typing.Tuple">Tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if hessian_required=True, then a tuple of (gradient,
hessian) is returned. If hessian_required=False, then just a gradient vector is returned. The returned
values are as follows:
grad (np.ndarray): vector gradients of the POSITIVE log-pdf with respect to param. shape=(n_param, 1)
hessian (np.ndarray): array of NEGATIVE second derivatives of the log-pdf with respect to param.
shape=(n_param, n_param)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">grad_log_p</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hessian_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gradient and Hessian of the log-Gaussian density, with respect to a given parameter.</span>

<span class="sd">    See also distribution.grad_log_p() for more information.</span>

<span class="sd">    Handles three possibilities:</span>
<span class="sd">        1) param is the response of the distribution, in which case the standard gradient of the log-density is</span>
<span class="sd">            returned.</span>
<span class="sd">        2) param is a parameter used in the computation of the mean (through a parameter object) and not in the</span>
<span class="sd">            computation of the precision, in which case the gradient is computed through application of the chain</span>
<span class="sd">            rule. Note that the Hessian calculated in this case is only valid if the dependence of self.mean on</span>
<span class="sd">            param is linear.</span>
<span class="sd">        3) neither of the above conditions is True, in which case the default finite-difference gradient is</span>
<span class="sd">            calculated (using self.grad_log_p_diff() and self.hessian_log_p_diff()). Note that as per those</span>
<span class="sd">            docstrings, it is only possible to compute gradients with respect to scalar or vector parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): current state information.</span>
<span class="sd">        param (str): name of the parameter for which we compute derivatives.</span>
<span class="sd">        hessian_required (bool): flag for whether the Hessian should be calculated and supplied as an output.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[np.ndarray, Tuple[np.ndarray, np.ndarray]]): if hessian_required=True, then a tuple of (gradient,</span>
<span class="sd">            hessian) is returned. If hessian_required=False, then just a gradient vector is returned. The returned</span>
<span class="sd">            values are as follows:</span>
<span class="sd">            grad (np.ndarray): vector gradients of the POSITIVE log-pdf with respect to param. shape=(n_param, 1)</span>
<span class="sd">            hessian (np.ndarray): array of NEGATIVE second derivatives of the log-pdf with respect to param.</span>
<span class="sd">            shape=(n_param, n_param)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">:</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="o">-</span><span class="n">Q</span> <span class="o">@</span> <span class="n">r</span>
        <span class="k">if</span> <span class="n">hessian_required</span><span class="p">:</span>
            <span class="n">hessian</span> <span class="o">=</span> <span class="n">Q</span>
            <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sparse</span><span class="o">.</span><span class="n">issparse</span><span class="p">(</span><span class="n">Q</span><span class="p">):</span>
                <span class="n">hessian</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">hessian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">grad</span><span class="p">,</span> <span class="n">hessian</span>

    <span class="k">elif</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">()</span> <span class="ow">and</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">():</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">grad_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">grad_times_prec</span> <span class="o">=</span> <span class="n">grad_param</span> <span class="o">@</span> <span class="n">Q</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="n">grad_times_prec</span> <span class="o">@</span> <span class="n">r</span>
        <span class="k">if</span> <span class="n">hessian_required</span><span class="p">:</span>
            <span class="n">hessian</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">grad_times_prec</span> <span class="o">@</span> <span class="n">grad_param</span><span class="o">.</span><span class="n">T</span>
            <span class="k">return</span> <span class="n">grad</span><span class="p">,</span> <span class="n">hessian</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_log_p_diff</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hessian_required</span><span class="p">:</span>
            <span class="n">hessian</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessian_log_p_diff</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">grad</span><span class="p">,</span> <span class="n">hessian</span>

    <span class="k">return</span> <span class="n">grad</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.Normal.rvs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rvs</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Generate random samples from the multivariate Gaussian distribution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary object containing the current state information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specifies the number of replicate samples required. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>random variables generated from distribution returned as p x n where p is the
dimensionality of the response.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate random samples from the multivariate Gaussian distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): dictionary object containing the current state information.</span>
<span class="sd">        n (int, optional): specifies the number of replicate samples required. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray): random variables generated from distribution returned as p x n where p is the</span>
<span class="sd">            dimensionality of the response.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_lower</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_response_upper</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gmrf</span><span class="o">.</span><span class="n">sample_normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gmrf</span><span class="o">.</span><span class="n">sample_truncated_normal</span><span class="p">(</span>
        <span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_response_lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_response_upper</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="openmcmc.distribution.location_scale.LogNormal" class="doc doc-heading">
            <code>LogNormal</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="openmcmc.distribution.location_scale.LocationScale" href="#openmcmc.distribution.location_scale.LocationScale">LocationScale</a></code></p>


      <p>Multivariate log-normal distribution class.</p>

              <details class="quote">
                <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">LogNormal</span><span class="p">(</span><span class="n">LocationScale</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Multivariate log-normal distribution class.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">log_p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">by_observation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the log of the probability density (for current parameter settings).</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): dictionary object containing the current state information. state[distribution.response]</span>
<span class="sd">                is expected to be p x n where: p is the number of responses; n is the number of independent</span>
<span class="sd">                replicates/observations.</span>
<span class="sd">            by_observation (bool, optional): If True, the log-likelihood is returned for each of the p responses of</span>
<span class="sd">                the distribution separately. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Union[np.ndarray, float]): POSITIVE log-density evaluated using the supplied state dictionary.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">log_p</span> <span class="o">=</span> <span class="n">gmrf</span><span class="o">.</span><span class="n">multivariate_normal_pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]),</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">by_observation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">by_observation</span><span class="p">:</span>
            <span class="n">log_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">log_p</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">log_p</span>

    <span class="k">def</span> <span class="nf">grad_log_p</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hessian_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate vector of derivatives of the log-pdf with respect to a given parameter, and if required, also generate the Hessian.</span>

<span class="sd">        See also distribution.grad_log_p() for more information.</span>

<span class="sd">        Handles 3 possibilities:</span>
<span class="sd">            1) param is the response of the distribution, in which case the standard gradient of the log-density is</span>
<span class="sd">                returned.</span>
<span class="sd">            2) param is a parameter used in the computation of the mean (through a parameter object) and not in the</span>
<span class="sd">                computation of the precision, in which case the gradient is computed through application of the chain</span>
<span class="sd">                rule. Note that the Hessian calculated in this case is only valid if the dependence of self.mean on</span>
<span class="sd">                param is linear.</span>
<span class="sd">            3) neither of the above conditions is True, in which case the default finite-difference gradient is</span>
<span class="sd">                calculated (using self.grad_log_p_diff() and self.hessian_log_p_diff()). Note that as per those</span>
<span class="sd">                docstrings, it is only possible to compute gradients with respect to scalar or vector parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): current state information.</span>
<span class="sd">            param (str): name of the parameter for which we compute derivatives.</span>
<span class="sd">            hessian_required (bool): flag for whether the Hessian should be calculated and supplied as an output.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Union[np.ndarray, Tuple[np.ndarray, np.ndarray]]): if hessian_required=True, then a tuple of (gradient,</span>
<span class="sd">                hessian) is returned. If hessian_required=False, then just a gradient vector is returned. The returned</span>
<span class="sd">                values are as follows:</span>
<span class="sd">                grad (np.ndarray): vector gradients of the POSITIVE log-pdf with respect to param. shape=(d, 1), where</span>
<span class="sd">                d is the dimensionality of param.</span>
<span class="sd">                hessian (np.ndarray): array of NEGATIVE second derivatives of the log-pdf with respect to param.</span>
<span class="sd">                shape=(d, d), where d is the dimensionality of param.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">])</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">grad</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">r</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">()</span> <span class="ow">and</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">():</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">])</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">grad_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
            <span class="n">grad</span> <span class="o">=</span> <span class="n">grad_param</span> <span class="o">@</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">grad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_log_p_diff</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hessian_required</span><span class="p">:</span>
            <span class="n">hessian</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessian_log_p</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">grad</span><span class="p">,</span> <span class="n">hessian</span>

        <span class="k">return</span> <span class="n">grad</span>

    <span class="k">def</span> <span class="nf">hessian_log_p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute Hessian of the log-density with respect to a given parameter.</span>

<span class="sd">        Handles 3 possibilities:</span>
<span class="sd">            1) param is the response of the distribution, in which case the Hessian of the log-density is computed</span>
<span class="sd">                directly.</span>
<span class="sd">            2) param is a parameter used in the computation of the mean (through a parameter object) and not in the</span>
<span class="sd">                computation of the precision, and the dependence of the mean parameter on param is linear. The chain</span>
<span class="sd">                rule is used to determine the Hessian.</span>
<span class="sd">            3) neither of the above conditions is True, in which case the default finite-difference gradient is</span>
<span class="sd">                calculated (using self.hessian_log_p_diff()). Note that as per the docstring of</span>
<span class="sd">                self.hessian_log_p_diff(), it is only possible to compute gradients with respect to scalar or vector</span>
<span class="sd">                parameters.</span>

<span class="sd">        NOTE: sparse implementation of response hessian currently converts Q from sparse.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): contains current state information.</span>
<span class="sd">            param (str): name of the parameter for which we compute derivatives.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (np.ndarray): Hessian of log-density wrt the specified param.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">:</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">])</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">reciprocal</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">sparse</span><span class="o">.</span><span class="n">issparse</span><span class="p">(</span><span class="n">Q</span><span class="p">):</span>
                <span class="n">hess_p</span> <span class="o">=</span> <span class="o">-</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">reciprocal</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">offsets</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">Q</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hess_p</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diagflat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">reciprocal</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Q</span> <span class="o">@</span> <span class="p">(</span><span class="n">r</span><span class="p">)))</span>

            <span class="n">dim</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>
            <span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijik-&gt;ijk&quot;</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ik, ij, jk -&gt; kij&quot;</span><span class="p">,</span> <span class="n">reciprocal</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">reciprocal</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">diag</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n</span> <span class="o">*</span> <span class="n">dim</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="n">dim</span><span class="p">))</span>
            <span class="n">hess_p</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">hess_p</span>

        <span class="k">elif</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">()</span> <span class="ow">and</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">():</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">grad_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
            <span class="n">hess_p</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">grad_param</span> <span class="o">@</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">grad_param</span><span class="o">.</span><span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hess_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessian_log_p_diff</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">hess_p</span>

    <span class="k">def</span> <span class="nf">rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate random samples from the multivariate log-Gaussian distribution.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (dict): dictionary object containing the current state information.</span>
<span class="sd">            n (int, optional): specifies the number of replicate samples required. Defaults to 1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (np.ndarray): random variables generated from distribution returned as p x n where p is the</span>
<span class="sd">                dimensionality of the response.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">gmrf</span><span class="o">.</span><span class="n">sample_normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.LogNormal.log_p" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_p</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">by_observation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Compute the log of the probability density (for current parameter settings).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary object containing the current state information. state[distribution.response]
is expected to be p x n where: p is the number of responses; n is the number of independent
replicates/observations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>by_observation</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the log-likelihood is returned for each of the p responses of
the distribution separately. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>POSITIVE log-density evaluated using the supplied state dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">log_p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">by_observation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the log of the probability density (for current parameter settings).</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): dictionary object containing the current state information. state[distribution.response]</span>
<span class="sd">            is expected to be p x n where: p is the number of responses; n is the number of independent</span>
<span class="sd">            replicates/observations.</span>
<span class="sd">        by_observation (bool, optional): If True, the log-likelihood is returned for each of the p responses of</span>
<span class="sd">            the distribution separately. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[np.ndarray, float]): POSITIVE log-density evaluated using the supplied state dictionary.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">log_p</span> <span class="o">=</span> <span class="n">gmrf</span><span class="o">.</span><span class="n">multivariate_normal_pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]),</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">by_observation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">by_observation</span><span class="p">:</span>
        <span class="n">log_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">log_p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">log_p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.LogNormal.grad_log_p" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">grad_log_p</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">hessian_required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Generate vector of derivatives of the log-pdf with respect to a given parameter, and if required, also generate the Hessian.</p>
<p>See also distribution.grad_log_p() for more information.</p>


<details class="handles-3-possibilities" open>
  <summary>Handles 3 possibilities</summary>
  <p>1) param is the response of the distribution, in which case the standard gradient of the log-density is
    returned.
2) param is a parameter used in the computation of the mean (through a parameter object) and not in the
    computation of the precision, in which case the gradient is computed through application of the chain
    rule. Note that the Hessian calculated in this case is only valid if the dependence of self.mean on
    param is linear.
3) neither of the above conditions is True, in which case the default finite-difference gradient is
    calculated (using self.grad_log_p_diff() and self.hessian_log_p_diff()). Note that as per those
    docstrings, it is only possible to compute gradients with respect to scalar or vector parameters.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>current state information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the parameter for which we compute derivatives.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>hessian_required</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>flag for whether the Hessian should be calculated and supplied as an output.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="typing.Tuple">Tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if hessian_required=True, then a tuple of (gradient,
hessian) is returned. If hessian_required=False, then just a gradient vector is returned. The returned
values are as follows:
grad (np.ndarray): vector gradients of the POSITIVE log-pdf with respect to param. shape=(d, 1), where
d is the dimensionality of param.
hessian (np.ndarray): array of NEGATIVE second derivatives of the log-pdf with respect to param.
shape=(d, d), where d is the dimensionality of param.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">grad_log_p</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hessian_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate vector of derivatives of the log-pdf with respect to a given parameter, and if required, also generate the Hessian.</span>

<span class="sd">    See also distribution.grad_log_p() for more information.</span>

<span class="sd">    Handles 3 possibilities:</span>
<span class="sd">        1) param is the response of the distribution, in which case the standard gradient of the log-density is</span>
<span class="sd">            returned.</span>
<span class="sd">        2) param is a parameter used in the computation of the mean (through a parameter object) and not in the</span>
<span class="sd">            computation of the precision, in which case the gradient is computed through application of the chain</span>
<span class="sd">            rule. Note that the Hessian calculated in this case is only valid if the dependence of self.mean on</span>
<span class="sd">            param is linear.</span>
<span class="sd">        3) neither of the above conditions is True, in which case the default finite-difference gradient is</span>
<span class="sd">            calculated (using self.grad_log_p_diff() and self.hessian_log_p_diff()). Note that as per those</span>
<span class="sd">            docstrings, it is only possible to compute gradients with respect to scalar or vector parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): current state information.</span>
<span class="sd">        param (str): name of the parameter for which we compute derivatives.</span>
<span class="sd">        hessian_required (bool): flag for whether the Hessian should be calculated and supplied as an output.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[np.ndarray, Tuple[np.ndarray, np.ndarray]]): if hessian_required=True, then a tuple of (gradient,</span>
<span class="sd">            hessian) is returned. If hessian_required=False, then just a gradient vector is returned. The returned</span>
<span class="sd">            values are as follows:</span>
<span class="sd">            grad (np.ndarray): vector gradients of the POSITIVE log-pdf with respect to param. shape=(d, 1), where</span>
<span class="sd">            d is the dimensionality of param.</span>
<span class="sd">            hessian (np.ndarray): array of NEGATIVE second derivatives of the log-pdf with respect to param.</span>
<span class="sd">            shape=(d, d), where d is the dimensionality of param.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">])</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">r</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">()</span> <span class="ow">and</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">():</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">])</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">grad_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="n">grad_param</span> <span class="o">@</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_log_p_diff</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">hessian_required</span><span class="p">:</span>
        <span class="n">hessian</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessian_log_p</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">grad</span><span class="p">,</span> <span class="n">hessian</span>

    <span class="k">return</span> <span class="n">grad</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.LogNormal.hessian_log_p" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hessian_log_p</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Compute Hessian of the log-density with respect to a given parameter.</p>


<details class="handles-3-possibilities" open>
  <summary>Handles 3 possibilities</summary>
  <p>1) param is the response of the distribution, in which case the Hessian of the log-density is computed
    directly.
2) param is a parameter used in the computation of the mean (through a parameter object) and not in the
    computation of the precision, and the dependence of the mean parameter on param is linear. The chain
    rule is used to determine the Hessian.
3) neither of the above conditions is True, in which case the default finite-difference gradient is
    calculated (using self.hessian_log_p_diff()). Note that as per the docstring of
    self.hessian_log_p_diff(), it is only possible to compute gradients with respect to scalar or vector
    parameters.</p>
</details>      


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>contains current state information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the parameter for which we compute derivatives.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hessian of log-density wrt the specified param.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">hessian_log_p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute Hessian of the log-density with respect to a given parameter.</span>

<span class="sd">    Handles 3 possibilities:</span>
<span class="sd">        1) param is the response of the distribution, in which case the Hessian of the log-density is computed</span>
<span class="sd">            directly.</span>
<span class="sd">        2) param is a parameter used in the computation of the mean (through a parameter object) and not in the</span>
<span class="sd">            computation of the precision, and the dependence of the mean parameter on param is linear. The chain</span>
<span class="sd">            rule is used to determine the Hessian.</span>
<span class="sd">        3) neither of the above conditions is True, in which case the default finite-difference gradient is</span>
<span class="sd">            calculated (using self.hessian_log_p_diff()). Note that as per the docstring of</span>
<span class="sd">            self.hessian_log_p_diff(), it is only possible to compute gradients with respect to scalar or vector</span>
<span class="sd">            parameters.</span>

<span class="sd">    NOTE: sparse implementation of response hessian currently converts Q from sparse.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): contains current state information.</span>
<span class="sd">        param (str): name of the parameter for which we compute derivatives.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray): Hessian of log-density wrt the specified param.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">:</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">])</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">reciprocal</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">sparse</span><span class="o">.</span><span class="n">issparse</span><span class="p">(</span><span class="n">Q</span><span class="p">):</span>
            <span class="n">hess_p</span> <span class="o">=</span> <span class="o">-</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">reciprocal</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">offsets</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hess_p</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diagflat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">reciprocal</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Q</span> <span class="o">@</span> <span class="p">(</span><span class="n">r</span><span class="p">)))</span>

        <span class="n">dim</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>
        <span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijik-&gt;ijk&quot;</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ik, ij, jk -&gt; kij&quot;</span><span class="p">,</span> <span class="n">reciprocal</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">reciprocal</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">diag</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n</span> <span class="o">*</span> <span class="n">dim</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="n">dim</span><span class="p">))</span>
        <span class="n">hess_p</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">hess_p</span>

    <span class="k">elif</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">()</span> <span class="ow">and</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">get_grad_param_list</span><span class="p">():</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">grad_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">hess_p</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">grad_param</span> <span class="o">@</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">grad_param</span><span class="o">.</span><span class="n">T</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hess_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessian_log_p_diff</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hess_p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="openmcmc.distribution.location_scale.LogNormal.rvs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rvs</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Generate random samples from the multivariate log-Gaussian distribution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary object containing the current state information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specifies the number of replicate samples required. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>random variables generated from distribution returned as p x n where p is the
dimensionality of the response.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/openmcmc/distribution/location_scale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rvs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate random samples from the multivariate log-Gaussian distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (dict): dictionary object containing the current state information.</span>
<span class="sd">        n (int, optional): specifies the number of replicate samples required. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray): random variables generated from distribution returned as p x n where p is the</span>
<span class="sd">            dimensionality of the response.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="o">.</span><span class="n">predictor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">gmrf</span><span class="o">.</span><span class="n">sample_normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.instant", "navigation.tabs", "navigation.top", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "tags": {"Pipelines": "pipelines"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>